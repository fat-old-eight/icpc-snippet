\section{数学}

\subsection{线性筛}

\inputminted{cpp}{icpc/math/prime/prime.cpp}

\subsection{高斯消元}

\inputminted{cpp}{icpc/math/gauss/gauss.cpp}

\subsection{乘法逆元}

\subsubsection{线性求逆元}

\inputminted{cpp}{icpc/math/inv/inv.cpp}

\subsubsection{线性求任意 $n$ 个数的逆元}

\inputminted{cpp}{icpc/math/inv/inv_any.cpp}

\subsection{欧几里得算法}

\subsubsection{扩展欧几里得算法}

\inputminted[mathescape]{cpp}{icpc/math/gcd/ex_eculid.cpp}

\subsubsection{高速 gcd}

\[
\gcd\left(a, b\right) = \begin{cases}
\gcd\left[|a - b|, \min(a, b)\right] & \text{a, b 奇} \\
\gcd\left(\frac{a}{2}, \frac{b}{2}\right) & \text{a, b 偶} \\
\gcd\left(a, \frac{b}{2}\right) & \text{a 奇, b 偶} \\
\gcd\left(\frac{a}{2}, b\right) & \text{a 偶, b 奇} 
\end{cases}
\]

\inputminted[mathescape]{cpp}{icpc/math/gcd/fast_gcd.cpp}

\subsection{Lucas 定理}

对于质数 $P$，有：

\[
\binom{n}{m}\bmod P =
\binom{\left\lfloor\frac{n}{P}\right\rfloor}{\left\lfloor\frac{m}{P}\right\rfloor}
\cdot \binom{n\bmod P}{m\bmod P}\bmod P
\]

\subsection{自动取模整形}

不会 barrett 取模优化。

\subsection{固定模数}

\inputminted{cpp}{icpc/math/modint/static_modint.cpp}

\subsection{矩阵类}

\inputminted{cpp}{icpc/math/matrix/matrix.cpp}

\subsection{扩展欧拉定理}

\[
    a^b \equiv \begin{cases}
        a^{b \bmod \varphi\left(m\right)},                &\gcd\left(a,m\right) =  1,                   \\
        a^b,                                   &\gcd\left(a,m\right)\ne 1, b <   \varphi\left(m\right), \\
        a^{\left(b \bmod \varphi\left(m\right)\right) + \varphi\left(m\right)}, &\gcd\left(a,m\right)\ne 1, b \ge \varphi\left(m\right).
      \end{cases} \pmod m
\]